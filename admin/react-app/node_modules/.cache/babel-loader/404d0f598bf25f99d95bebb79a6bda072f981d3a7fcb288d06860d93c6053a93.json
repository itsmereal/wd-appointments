{"ast":null,"code":"import axios from'axios';// Validate WordPress environment\nconst validateWPEnvironment=()=>{if(typeof window.wdAppointments==='undefined'){throw new Error('WordPress environment not detected. Make sure the plugin is properly activated.');}if(!window.wdAppointments.apiUrl){throw new Error('API URL not found. Check WordPress REST API configuration.');}if(!window.wdAppointments.nonce){throw new Error('Security nonce not found. Try refreshing the page.');}};// Initialize API configuration\nconst initializeAPI=()=>{validateWPEnvironment();console.log('Initializing API with URL:',window.wdAppointments.apiUrl);console.log('Using nonce:',window.wdAppointments.nonce);const instance=axios.create({baseURL:window.wdAppointments.apiUrl,headers:{'Content-Type':'application/json','X-WP-Nonce':window.wdAppointments.nonce},// Add credentials to enable cookies\nwithCredentials:true});// Add request interceptor for debugging\ninstance.interceptors.request.use(config=>{console.log('Making request to:',config.url);console.log('Request headers:',config.headers);return config;},error=>{console.error('Request error:',error);return Promise.reject(error);});return instance;};// Create axios instance with default config\nconst api=initializeAPI();// Settings API\nexport const settingsAPI={getSettings:async()=>{try{console.log('Fetching settings...');const response=await api.get('/settings');console.log('Settings response:',response);return response.data;}catch(error){var _error$response;console.error('Error fetching settings:',error);if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===404){throw new Error('Settings endpoint not found. Please check if the plugin is properly activated and permalinks are updated.');}throw error;}},updateSettings:settings=>api.post('/settings',settings)};// Forms API\nexport const formsAPI={getForms:()=>api.get('/forms'),getForm:id=>api.get(`/forms/${id}`),createForm:form=>api.post('/forms',form),updateForm:(id,form)=>api.put(`/forms/${id}`,form),deleteForm:id=>api.delete(`/forms/${id}`)};// Appointments API\nexport const appointmentsAPI={getAppointments:params=>api.get('/appointments',{params}),getAppointment:id=>api.get(`/appointments/${id}`),updateAppointment:(id,appointment)=>api.put(`/appointments/${id}`,appointment),deleteAppointment:id=>api.delete(`/appointments/${id}`),sendReminder:id=>api.post(`/appointments/${id}/remind`)};// Calendar API\nexport const calendarAPI={authenticate:provider=>api.post(`/calendar/${provider}/auth`),disconnect:provider=>api.post(`/calendar/${provider}/disconnect`),getEvents:params=>api.get('/calendar/events',{params})};// Enhanced error handler middleware\napi.interceptors.response.use(response=>{console.log('Successful response:',response);return response.data;},error=>{var _error$response$data;console.error('Response error:',error);// Handle different types of errors\nif(error.response){// Server responded with error\nconsole.error('Server error:',error.response);switch(error.response.status){case 404:throw new Error('API endpoint not found. Check plugin activation and permalinks.');case 401:throw new Error('Authentication required. Please refresh the page.');case 403:throw new Error('You do not have permission to perform this action.');case 500:throw new Error('Server error. Please check WordPress error logs.');default:throw new Error(((_error$response$data=error.response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'An error occurred');}}else if(error.request){// Request made but no response\nconsole.error('No response received:',error.request);throw new Error('No response from server. Check your WordPress installation.');}else{// Request setup error\nconsole.error('Request setup error:',error.message);throw new Error(error.message||'Error setting up request');}});export default api;","map":{"version":3,"names":["axios","validateWPEnvironment","window","wdAppointments","Error","apiUrl","nonce","initializeAPI","console","log","instance","create","baseURL","headers","withCredentials","interceptors","request","use","config","url","error","Promise","reject","api","settingsAPI","getSettings","response","get","data","_error$response","status","updateSettings","settings","post","formsAPI","getForms","getForm","id","createForm","form","updateForm","put","deleteForm","delete","appointmentsAPI","getAppointments","params","getAppointment","updateAppointment","appointment","deleteAppointment","sendReminder","calendarAPI","authenticate","provider","disconnect","getEvents","_error$response$data","message"],"sources":["/Users/real/Local Sites/wdbooking/app/public/wp-content/plugins/wd-appointments/admin/react-app/src/services/api.js"],"sourcesContent":["import axios from 'axios';\n\n// Validate WordPress environment\nconst validateWPEnvironment = () => {\n  if (typeof window.wdAppointments === 'undefined') {\n    throw new Error(\n      'WordPress environment not detected. Make sure the plugin is properly activated.'\n    );\n  }\n  if (!window.wdAppointments.apiUrl) {\n    throw new Error(\n      'API URL not found. Check WordPress REST API configuration.'\n    );\n  }\n  if (!window.wdAppointments.nonce) {\n    throw new Error('Security nonce not found. Try refreshing the page.');\n  }\n};\n\n// Initialize API configuration\nconst initializeAPI = () => {\n  validateWPEnvironment();\n  console.log('Initializing API with URL:', window.wdAppointments.apiUrl);\n  console.log('Using nonce:', window.wdAppointments.nonce);\n\n  const instance = axios.create({\n    baseURL: window.wdAppointments.apiUrl,\n    headers: {\n      'Content-Type': 'application/json',\n      'X-WP-Nonce': window.wdAppointments.nonce,\n    },\n    // Add credentials to enable cookies\n    withCredentials: true,\n  });\n\n  // Add request interceptor for debugging\n  instance.interceptors.request.use(\n    (config) => {\n      console.log('Making request to:', config.url);\n      console.log('Request headers:', config.headers);\n      return config;\n    },\n    (error) => {\n      console.error('Request error:', error);\n      return Promise.reject(error);\n    }\n  );\n\n  return instance;\n};\n\n// Create axios instance with default config\nconst api = initializeAPI();\n\n// Settings API\nexport const settingsAPI = {\n  getSettings: async () => {\n    try {\n      console.log('Fetching settings...');\n      const response = await api.get('/settings');\n      console.log('Settings response:', response);\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching settings:', error);\n      if (error.response?.status === 404) {\n        throw new Error(\n          'Settings endpoint not found. Please check if the plugin is properly activated and permalinks are updated.'\n        );\n      }\n      throw error;\n    }\n  },\n  updateSettings: (settings) => api.post('/settings', settings),\n};\n\n// Forms API\nexport const formsAPI = {\n  getForms: () => api.get('/forms'),\n  getForm: (id) => api.get(`/forms/${id}`),\n  createForm: (form) => api.post('/forms', form),\n  updateForm: (id, form) => api.put(`/forms/${id}`, form),\n  deleteForm: (id) => api.delete(`/forms/${id}`),\n};\n\n// Appointments API\nexport const appointmentsAPI = {\n  getAppointments: (params) => api.get('/appointments', { params }),\n  getAppointment: (id) => api.get(`/appointments/${id}`),\n  updateAppointment: (id, appointment) =>\n    api.put(`/appointments/${id}`, appointment),\n  deleteAppointment: (id) => api.delete(`/appointments/${id}`),\n  sendReminder: (id) => api.post(`/appointments/${id}/remind`),\n};\n\n// Calendar API\nexport const calendarAPI = {\n  authenticate: (provider) => api.post(`/calendar/${provider}/auth`),\n  disconnect: (provider) => api.post(`/calendar/${provider}/disconnect`),\n  getEvents: (params) => api.get('/calendar/events', { params }),\n};\n\n// Enhanced error handler middleware\napi.interceptors.response.use(\n  (response) => {\n    console.log('Successful response:', response);\n    return response.data;\n  },\n  (error) => {\n    console.error('Response error:', error);\n    // Handle different types of errors\n    if (error.response) {\n      // Server responded with error\n      console.error('Server error:', error.response);\n      switch (error.response.status) {\n        case 404:\n          throw new Error(\n            'API endpoint not found. Check plugin activation and permalinks.'\n          );\n        case 401:\n          throw new Error('Authentication required. Please refresh the page.');\n        case 403:\n          throw new Error('You do not have permission to perform this action.');\n        case 500:\n          throw new Error('Server error. Please check WordPress error logs.');\n        default:\n          throw new Error(error.response.data?.message || 'An error occurred');\n      }\n    } else if (error.request) {\n      // Request made but no response\n      console.error('No response received:', error.request);\n      throw new Error(\n        'No response from server. Check your WordPress installation.'\n      );\n    } else {\n      // Request setup error\n      console.error('Request setup error:', error.message);\n      throw new Error(error.message || 'Error setting up request');\n    }\n  }\n);\n\nexport default api;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB;AACA,KAAM,CAAAC,qBAAqB,CAAGA,CAAA,GAAM,CAClC,GAAI,MAAO,CAAAC,MAAM,CAACC,cAAc,GAAK,WAAW,CAAE,CAChD,KAAM,IAAI,CAAAC,KAAK,CACb,iFACF,CAAC,CACH,CACA,GAAI,CAACF,MAAM,CAACC,cAAc,CAACE,MAAM,CAAE,CACjC,KAAM,IAAI,CAAAD,KAAK,CACb,4DACF,CAAC,CACH,CACA,GAAI,CAACF,MAAM,CAACC,cAAc,CAACG,KAAK,CAAE,CAChC,KAAM,IAAI,CAAAF,KAAK,CAAC,oDAAoD,CAAC,CACvE,CACF,CAAC,CAED;AACA,KAAM,CAAAG,aAAa,CAAGA,CAAA,GAAM,CAC1BN,qBAAqB,CAAC,CAAC,CACvBO,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAEP,MAAM,CAACC,cAAc,CAACE,MAAM,CAAC,CACvEG,OAAO,CAACC,GAAG,CAAC,cAAc,CAAEP,MAAM,CAACC,cAAc,CAACG,KAAK,CAAC,CAExD,KAAM,CAAAI,QAAQ,CAAGV,KAAK,CAACW,MAAM,CAAC,CAC5BC,OAAO,CAAEV,MAAM,CAACC,cAAc,CAACE,MAAM,CACrCQ,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,YAAY,CAAEX,MAAM,CAACC,cAAc,CAACG,KACtC,CAAC,CACD;AACAQ,eAAe,CAAE,IACnB,CAAC,CAAC,CAEF;AACAJ,QAAQ,CAACK,YAAY,CAACC,OAAO,CAACC,GAAG,CAC9BC,MAAM,EAAK,CACVV,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAES,MAAM,CAACC,GAAG,CAAC,CAC7CX,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAES,MAAM,CAACL,OAAO,CAAC,CAC/C,MAAO,CAAAK,MAAM,CACf,CAAC,CACAE,KAAK,EAAK,CACTZ,OAAO,CAACY,KAAK,CAAC,gBAAgB,CAAEA,KAAK,CAAC,CACtC,MAAO,CAAAC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CAC9B,CACF,CAAC,CAED,MAAO,CAAAV,QAAQ,CACjB,CAAC,CAED;AACA,KAAM,CAAAa,GAAG,CAAGhB,aAAa,CAAC,CAAC,CAE3B;AACA,MAAO,MAAM,CAAAiB,WAAW,CAAG,CACzBC,WAAW,CAAE,KAAAA,CAAA,GAAY,CACvB,GAAI,CACFjB,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC,CACnC,KAAM,CAAAiB,QAAQ,CAAG,KAAM,CAAAH,GAAG,CAACI,GAAG,CAAC,WAAW,CAAC,CAC3CnB,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEiB,QAAQ,CAAC,CAC3C,MAAO,CAAAA,QAAQ,CAACE,IAAI,CACtB,CAAE,MAAOR,KAAK,CAAE,KAAAS,eAAA,CACdrB,OAAO,CAACY,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChD,GAAI,EAAAS,eAAA,CAAAT,KAAK,CAACM,QAAQ,UAAAG,eAAA,iBAAdA,eAAA,CAAgBC,MAAM,IAAK,GAAG,CAAE,CAClC,KAAM,IAAI,CAAA1B,KAAK,CACb,2GACF,CAAC,CACH,CACA,KAAM,CAAAgB,KAAK,CACb,CACF,CAAC,CACDW,cAAc,CAAGC,QAAQ,EAAKT,GAAG,CAACU,IAAI,CAAC,WAAW,CAAED,QAAQ,CAC9D,CAAC,CAED;AACA,MAAO,MAAM,CAAAE,QAAQ,CAAG,CACtBC,QAAQ,CAAEA,CAAA,GAAMZ,GAAG,CAACI,GAAG,CAAC,QAAQ,CAAC,CACjCS,OAAO,CAAGC,EAAE,EAAKd,GAAG,CAACI,GAAG,CAAC,UAAUU,EAAE,EAAE,CAAC,CACxCC,UAAU,CAAGC,IAAI,EAAKhB,GAAG,CAACU,IAAI,CAAC,QAAQ,CAAEM,IAAI,CAAC,CAC9CC,UAAU,CAAEA,CAACH,EAAE,CAAEE,IAAI,GAAKhB,GAAG,CAACkB,GAAG,CAAC,UAAUJ,EAAE,EAAE,CAAEE,IAAI,CAAC,CACvDG,UAAU,CAAGL,EAAE,EAAKd,GAAG,CAACoB,MAAM,CAAC,UAAUN,EAAE,EAAE,CAC/C,CAAC,CAED;AACA,MAAO,MAAM,CAAAO,eAAe,CAAG,CAC7BC,eAAe,CAAGC,MAAM,EAAKvB,GAAG,CAACI,GAAG,CAAC,eAAe,CAAE,CAAEmB,MAAO,CAAC,CAAC,CACjEC,cAAc,CAAGV,EAAE,EAAKd,GAAG,CAACI,GAAG,CAAC,iBAAiBU,EAAE,EAAE,CAAC,CACtDW,iBAAiB,CAAEA,CAACX,EAAE,CAAEY,WAAW,GACjC1B,GAAG,CAACkB,GAAG,CAAC,iBAAiBJ,EAAE,EAAE,CAAEY,WAAW,CAAC,CAC7CC,iBAAiB,CAAGb,EAAE,EAAKd,GAAG,CAACoB,MAAM,CAAC,iBAAiBN,EAAE,EAAE,CAAC,CAC5Dc,YAAY,CAAGd,EAAE,EAAKd,GAAG,CAACU,IAAI,CAAC,iBAAiBI,EAAE,SAAS,CAC7D,CAAC,CAED;AACA,MAAO,MAAM,CAAAe,WAAW,CAAG,CACzBC,YAAY,CAAGC,QAAQ,EAAK/B,GAAG,CAACU,IAAI,CAAC,aAAaqB,QAAQ,OAAO,CAAC,CAClEC,UAAU,CAAGD,QAAQ,EAAK/B,GAAG,CAACU,IAAI,CAAC,aAAaqB,QAAQ,aAAa,CAAC,CACtEE,SAAS,CAAGV,MAAM,EAAKvB,GAAG,CAACI,GAAG,CAAC,kBAAkB,CAAE,CAAEmB,MAAO,CAAC,CAC/D,CAAC,CAED;AACAvB,GAAG,CAACR,YAAY,CAACW,QAAQ,CAACT,GAAG,CAC1BS,QAAQ,EAAK,CACZlB,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAEiB,QAAQ,CAAC,CAC7C,MAAO,CAAAA,QAAQ,CAACE,IAAI,CACtB,CAAC,CACAR,KAAK,EAAK,KAAAqC,oBAAA,CACTjD,OAAO,CAACY,KAAK,CAAC,iBAAiB,CAAEA,KAAK,CAAC,CACvC;AACA,GAAIA,KAAK,CAACM,QAAQ,CAAE,CAClB;AACAlB,OAAO,CAACY,KAAK,CAAC,eAAe,CAAEA,KAAK,CAACM,QAAQ,CAAC,CAC9C,OAAQN,KAAK,CAACM,QAAQ,CAACI,MAAM,EAC3B,IAAK,IAAG,CACN,KAAM,IAAI,CAAA1B,KAAK,CACb,iEACF,CAAC,CACH,IAAK,IAAG,CACN,KAAM,IAAI,CAAAA,KAAK,CAAC,mDAAmD,CAAC,CACtE,IAAK,IAAG,CACN,KAAM,IAAI,CAAAA,KAAK,CAAC,oDAAoD,CAAC,CACvE,IAAK,IAAG,CACN,KAAM,IAAI,CAAAA,KAAK,CAAC,kDAAkD,CAAC,CACrE,QACE,KAAM,IAAI,CAAAA,KAAK,CAAC,EAAAqD,oBAAA,CAAArC,KAAK,CAACM,QAAQ,CAACE,IAAI,UAAA6B,oBAAA,iBAAnBA,oBAAA,CAAqBC,OAAO,GAAI,mBAAmB,CAAC,CACxE,CACF,CAAC,IAAM,IAAItC,KAAK,CAACJ,OAAO,CAAE,CACxB;AACAR,OAAO,CAACY,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAACJ,OAAO,CAAC,CACrD,KAAM,IAAI,CAAAZ,KAAK,CACb,6DACF,CAAC,CACH,CAAC,IAAM,CACL;AACAI,OAAO,CAACY,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAACsC,OAAO,CAAC,CACpD,KAAM,IAAI,CAAAtD,KAAK,CAACgB,KAAK,CAACsC,OAAO,EAAI,0BAA0B,CAAC,CAC9D,CACF,CACF,CAAC,CAED,cAAe,CAAAnC,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}